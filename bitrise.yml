format_version: "11"
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

workflows:
  run_build:
    steps:
      - activate-ssh-key@4:
          run_if: '{{getenv "SSH_RSA_PRIVATE_KEY" | ne ""}}'
      - git-clone@8: {}
      - restore-cocoapods-cache@2: {}
      - restore-spm-cache@1: {}
      - cocoapods-install@2: {}
      - xcode-archive@4:
          inputs:
            - project_path: "Dayline.xcworkspace"
            - scheme: "DaylineApp"
            - configuration: "Release"
            - export_method: "development"   # можно заменить на app-store для релиза
      - save-cocoapods-cache@2: {}
      - save-spm-cache@1: {}
      - deploy-to-bitrise-io@2: {}

app:
  envs:
    - BITRISE_PROJECT_PATH: "Dayline.xcworkspace"
    - BITRISE_SCHEME: "DaylineApp"
    - BITRISE_EXPORT_METHOD: "development"
