format_version: "11"
default_step_lib_source: "https://github.com/bitrise-io/bitrise-steplib.git"

workflows:
  primary:
    steps:
      - git-clone@8: {}
      - cache-pull@2: {}

      # Установка CocoaPods (создаст Pods/ и Dayline.xcworkspace)
      - cocoapods-install@2:
          inputs:
            - podfile_path: "./Podfile"
            - is_update: "true"
            - verbose: "true"

      # Сборка и прогон на симуляторе через .xcworkspace
      - xcode-test@2:
          inputs:
            - project_path: "Dayline.xcworkspace"
            - scheme: "DaylineApp"
            - simulator_device: "iPhone 14"
            - simulator_os_version: "latest"
            - is_clean_build: "yes"

      - cache-push@2: {}
